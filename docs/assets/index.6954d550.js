var P=Object.defineProperty,R=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var C=(e,t,n)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,f=(e,t)=>{for(var n in t||(t={}))U.call(t,n)&&C(e,n,t[n]);if(w)for(var n of w(t))$.call(t,n)&&C(e,n,t[n]);return e},m=(e,t)=>R(e,j(t));import{c as g,j as o,H as z,S as T,r as p,L as S,u as I,M as G,a as l,P as W,b as x,T as k,d as q,e as H,F as L,B as M,A as K,f as Y,l as Z,g as V,h as X,v as J,n as Q,R as ee,i as te}from"./vendor.6b9b0f14.js";const oe=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}};oe();const ne="_controls_kstyc_24",re="_buttons_kstyc_33";var y={controls:ne,buttons:re};const ae="_cache_feq8y_1";var ce={cache:ae};const se=()=>{const e=g({[y.buttons]:!0,[ce.cache]:!0});return o("button",{className:e,onClick:()=>{T.fire({icon:"warning",title:"Confirmaci\xF3n de eliminaci\xF3n de cach\xE9 de mapa\u2026",text:"Si no tienes conexi\xF3n, perder\xE1s tus datos",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ok, b\xF3rralo!",cancelButtonText:"Cancelar"}).then(n=>{n.isConfirmed&&"caches"in window&&caches.delete("cache-map").then(c=>{console.log(c,"clear cache-map operation")}).catch(c=>{console.log(c)})})},title:"Borrar Cache",children:o(z,{})})},h=p.exports.createContext({}),ie=(e,t)=>{switch(t.type){case"addTrack":return m(f({},e),{data:t.payload});case"startLocation":return m(f({},e),{location:t.payload});case"deleteTrack":return m(f({},e),{deleteTrack:t.payload,data:"",infoTrack:{}});case"setInfo":return m(f({},e),{infoTrack:t.payload});case"setDisplay":return m(f({},e),{displayInfo:t.payload});case"setUserAccurcy":return m(f({},e),{userAccuracy:Math.round(t.payload*100)/100});default:return e}},le={data:"",location:!1,deleteTrack:!1,infoTrack:{},displayInfo:!1,userAccuracy:0},de=({children:e})=>{const[t,n]=p.exports.useReducer(ie,le),c=s=>{n({type:"addTrack",payload:s})},r=s=>{n({type:"startLocation",payload:s})},a=s=>{n({type:"deleteTrack",payload:s})},i=s=>{n({type:"setInfo",payload:s})},d=s=>{n({type:"setDisplay",payload:s})},u=s=>{n({type:"setUserAccurcy",payload:s})};return o(h.Provider,{value:{trackState:t,setTrack:c,setLocation:r,deleteTrack:a,setInfoTrack:i,setDisplayInfo:d,setUserAccuracy:u},children:e})};var pe="/map-gpx/markers/marker-icon.png",ue="/map-gpx/markers/marker-shadow.png";const he=S.icon({iconSize:[25,40],iconAnchor:[12.5,40],popupAnchor:[0,-40],iconUrl:pe,shadowUrl:ue});S.Marker.prototype.options.icon=he;const fe=()=>{const{trackState:{location:e,userAccuracy:t},setUserAccuracy:n}=p.exports.useContext(h),[c,r]=p.exports.useState(null),a=I();return p.exports.useEffect(()=>(e?a.locate({watch:!0,timeout:5e3}).on("locationfound",i=>{r(i.latlng),n(i.accuracy),a.flyTo(i.latlng,a.getZoom())}):r(null),()=>{a.stopLocate()}),[e]),c===null?null:o(G,{position:c,children:l(W,{children:["Precisi\xF3n de la posici\xF3n: ",t," m"]})})},me=()=>l(x,{position:"topright",children:[o(x.BaseLayer,{checked:!0,name:"Mapa raster IGN - Spain",children:o(k,{maxZoom:17,url:"https://tms-mapa-raster.ign.es/1.0.0/mapa-raster/{z}/{x}/{-y}.jpeg",attribution:'MTN r\xE1ster CC BY 4.0 <a href="http://www.ign.es/" target="_blank" rel="noopener noreferrer"><b>ign.es</b></a>',crossOrigin:!0})}),o(x.BaseLayer,{name:"Ortoimagen PNOA - Spain",children:o(k,{url:"https://tms-pnoa-ma.ign.es/1.0.0/pnoa-ma/{z}/{x}/{-y}.jpeg",attribution:'Ortofoto PNOA CC-BY 4.0 <a href="http://www.scne.es" target="_blank" rel="noopener noreferrer"><b>scne.es</b></a>',crossOrigin:!0})}),o(x.BaseLayer,{name:"OpenStreetMap",children:o(k,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright"  target="_blank" rel="noopener noreferrer">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",crossOrigin:!0})}),o(x.BaseLayer,{name:"OpenTopoMap",children:o(k,{maxZoom:17,attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright" target="_blank" rel="noopener noreferrer">OpenStreetMap</a> contributors',url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",crossOrigin:!0})})]}),ge="_leafletContainer_nr6u5_1";var ye={leafletContainer:ge};const xe=()=>{var n;const e=[[24.9300000311,-19.6],[46.0700000311,5.6]],{leafletContainer:t}=ye;return l(q,{bounds:e,className:t,children:[((n=window.localStorage.getItem("gpx"))==null?void 0:n.length)===0?null:o(je,{}),o(fe,{}),o(H,{}),o(me,{})]})},ke="_overlay_oj9hv_1",ve="_modal_oj9hv_11",_e="_show_oj9hv_25",be="_header_oj9hv_31",we="_content_oj9hv_41",Ce="_footer_oj9hv_52",Te="_button_oj9hv_58";var N={overlay:ke,modal:ve,show:_e,header:be,content:we,footer:Ce,button:Te};const Se=g.bind(N),Ie=()=>{const{trackState:{displayInfo:e,infoTrack:t},setDisplayInfo:n}=p.exports.useContext(h),{name:c,distance:r,maxElevation:a,time:i}=t,d=D=>{D.stopPropagation()},{overlay:u,modal:s,show:v,header:B,content:b,footer:F,button:E}=N,O=Se({[s]:!0,[v]:e});return l(L,{children:[e&&o("div",{className:u,onClick:()=>n(!1)}),l("div",{className:O,onClick:d,children:[l("div",{className:B,children:[o("h2",{children:"Track Info"}),o("div",{style:{fontSize:"1.4rem"},children:o(M,{})})]}),c?l("div",{className:b,children:[l("p",{children:[o("b",{children:"Nombre:"})," ",c]}),l("p",{children:[o("b",{children:"Distancia:"})," ",r]}),l("p",{children:[o("b",{children:"M\xE1x. Elevaci\xF3n:"})," ",a]}),l("p",{children:[o("b",{children:"Tiempo:"})," ",i]})]}):o("div",{className:b,children:o("p",{style:{textAlign:"center"},children:o("strong",{children:"Sin Informaci\xF3n \u{1F641}"})})}),o("div",{className:F,children:o("button",{className:E,onClick:()=>n(!1),children:"OK"})})]})]})},Le="_remove_1dphq_1";var Me={remove:Le};const Ne=()=>{const{deleteTrack:e,trackState:t}=p.exports.useContext(h),n=g({[y.buttons]:!0,[Me.remove]:!0});return o("button",{className:n,onClick:()=>{window.localStorage.removeItem("gpx"),e(!t.deleteTrack)},title:"Eliminar Track",children:o(K,{})})},Ae="_info_fq53e_1";var Be={info:Ae};const Fe=()=>{const{setDisplayInfo:e}=p.exports.useContext(h),t=g({[y.buttons]:!0,[Be.info]:!0});return o("button",{className:t,onClick:()=>e(!0),title:"Info Track",children:o(M,{})})},Ee="_location_vrttu_1",Oe="_active_vrttu_6";var _={location:Ee,active:Oe};const De=g.bind(_),Pe=()=>{const{setLocation:e,trackState:t}=p.exports.useContext(h),n=De({[y.buttons]:!0,[_.location]:!0,[_.active]:t.location});return o("button",{className:n,onClick:()=>e(!t.location),title:"Iniciar Geolocalizaci\xF3n",children:o(Y,{})})},Re=e=>{const t={};t.name=`${e.get_name()}`,t.distance=`${Math.round(e.get_distance()/1e3*100)/100} km`,t.maxElevation=`${Math.round(e.get_elevation_max()*100)/100} m`;const n=Math.round(e.get_total_time()/36e5*100)/100,c=Math.ceil((n-Math.floor(n))*60);return t.time=`${Math.floor(n)} horas y ${c} minutos`,t},je=()=>{const e=I(),{trackState:{deleteTrack:t,data:n},setInfoTrack:c}=p.exports.useContext(h);return p.exports.useEffect(()=>{const r=window.localStorage.getItem("gpx")||"",a=new Z.exports.GPX(r,{async:!0,marker_options:{wptIconUrls:{"":"markers/pin-icon-wpt.png"},startIconUrl:"markers/pin-icon-start.png",endIconUrl:"markers/pin-icon-end.png",shadowUrl:"markers/pin-shadow.png"}}).on("loaded",i=>{const d=i.target;c(Re(d)),e.fitBounds(d.getBounds())}).addTo(e);return()=>{e.removeLayer(a)}},[e,t,n]),null},Ue="_label_1x4aj_1",$e="_input_1x4aj_5";var A={label:Ue,input:$e};const ze=()=>{const e=g({[y.buttons]:!0,[A.label]:!0}),{setTrack:t}=p.exports.useContext(h),n=p.exports.useRef(null),c=()=>{n.current&&(n.current.value="")},r=a=>{const i=a.target,d=new FileReader;d.onload=()=>{const u=d.result;t(u),window.localStorage.setItem("gpx",u)},i.files&&d.readAsText(i.files[0])};return l(L,{children:[o("label",{className:e,htmlFor:"input-track",title:"A\xF1adir Track",children:o(V,{})}),o("input",{accept:"application/gpx+xml",className:A.input,id:"input-track",onChange:r,onClick:c,ref:n,type:"file"})]})},Ge=()=>l(de,{children:[l("header",{children:[o("h4",{children:"Camina \u{1F97E} con mi App GPS"}),l("p",{children:["(PWA - React+TS/React-Leaflet)",o("a",{href:"https://github.com/emarifer/map-gpx/tree/added_css_modules",rel:"noopener noreferrer",target:"_blank",title:"Mi GitHub",children:o(X,{})})]}),l("div",{className:y.controls,children:[o(ze,{}),o(Pe,{}),o(Ne,{}),o(Fe,{}),o(se,{})]})]}),o(xe,{}),o(Ie,{}),l("footer",{children:["MIT Licensed | Copyright \xA9 ",new Date().getFullYear()," Enrique Mar\xEDn"]})]});function We(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:c,onRegistered:r,onRegisterError:a}=e;let i,d;const u=async(s=!0)=>{s&&(i==null||i.addEventListener("controlling",v=>{v.isUpdate&&window.location.reload()})),d&&d.waiting&&await Q(d.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){i=new J("/map-gpx/sw.js",{scope:"/map-gpx/"}),i.addEventListener("activated",s=>{s.isUpdate||c==null||c()});{const s=()=>{n==null||n()};i.addEventListener("waiting",s),i.addEventListener("externalwaiting",s)}i.register({immediate:t}).then(s=>{d=s,r==null||r(s)}).catch(s=>{a==null||a(s)})}return u}const qe=We({onNeedRefresh(){T.fire({icon:"info",title:"Nuevo contenido disponible!!",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ok, Actual\xEDzame!",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&qe()})}});ee.render(o(te.StrictMode,{children:o(Ge,{})}),document.getElementById("root"));
