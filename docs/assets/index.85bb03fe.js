var _=Object.defineProperty,L=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var w=(t,e,n)=>e in t?_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,h=(t,e)=>{for(var n in e||(e={}))A.call(e,n)&&w(t,n,e[n]);if(k)for(var n of k(e))N.call(e,n)&&w(t,n,e[n]);return t},m=(t,e)=>L(t,M(e));import{j as o,H as O,S as x,r as p,L as y,u as v,M as E,a as l,P as D,b as g,W as T,T as b,c as R,d as B,F as C,B as I,A as F,e as P,f as U,v as W,n as G,R as $,g as j}from"./vendor.d65df07c.js";const z=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}};z();const K=()=>o("button",{title:"Delete Cache",onClick:()=>{x.fire({icon:"warning",title:"Confirmation of deleting map cache\u2026",text:"If you don't have a connection, you will lose your data",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ok, delete it!"}).then(e=>{e.isConfirmed&&"caches"in window&&caches.delete("cache-map").then(n=>{console.log(n,"clear cache-map operation")}).catch(n=>{console.log(n)})})},className:"buttons buttons__cache",children:o(O,{})}),u=p.exports.createContext({}),q=(t,e)=>{switch(e.type){case"addTrack":return m(h({},t),{data:e.payload});case"startLocation":return m(h({},t),{location:e.payload});case"deleteTrack":return m(h({},t),{deleteTrack:e.payload,data:"",infoTrack:{}});case"setInfo":return m(h({},t),{infoTrack:e.payload});case"setDisplay":return m(h({},t),{displayInfo:e.payload});case"setUserAccurcy":return m(h({},t),{userAccuracy:Math.round(e.payload*100)/100});default:return t}},H={data:"",location:!1,deleteTrack:!1,infoTrack:{},displayInfo:!1,userAccuracy:0},V=({children:t})=>{const[e,n]=p.exports.useReducer(q,H),s=i=>{n({type:"addTrack",payload:i})},a=i=>{n({type:"startLocation",payload:i})},r=i=>{n({type:"deleteTrack",payload:i})},c=i=>{n({type:"setInfo",payload:i})},d=i=>{n({type:"setDisplay",payload:i})},f=i=>{n({type:"setUserAccurcy",payload:i})};return o(u.Provider,{value:{trackState:e,setTrack:s,setLocation:a,deleteTrack:r,setInfoTrack:c,setDisplayInfo:d,setUserAccuracy:f},children:t})};var X="/map-gpx/markers/marker-icon.png",Y="/map-gpx/markers/marker-shadow.png";const J=y.icon({iconSize:[25,40],iconAnchor:[12.5,40],popupAnchor:[0,-40],iconUrl:X,shadowUrl:Y});y.Marker.prototype.options.icon=J;const Q=()=>{const{trackState:{location:t,userAccuracy:e},setUserAccuracy:n}=p.exports.useContext(u),[s,a]=p.exports.useState(null),r=v();return p.exports.useEffect(()=>(t?r.locate({watch:!0,timeout:5e3}).on("locationfound",c=>{a(c.latlng),n(c.accuracy)}):a(null),()=>{r.stopLocate()}),[t]),s===null?null:o(E,{position:s,children:l(D,{children:["You are less than ",e," meters"]})})},Z=()=>l(g,{position:"topright",children:[o(g.BaseLayer,{checked:!0,name:"Mapa raster IGN - Spain",children:o(T,{layers:"mtn_rasterizado",url:"https://www.ign.es/wms-inspire/mapa-raster",attribution:'\xA9 <a href="http://www.ign.es/ign/main/index.do" target="_blank">Instituto Geogr\xE1fico Nacional de Espa\xF1a</a> contributors',crossOrigin:!0})}),o(g.BaseLayer,{name:"Ortoimagen PNOA - Spain",children:o(T,{layers:"OI.OrthoimageCoverage",url:"https://www.ign.es/wms-inspire/pnoa-ma",attribution:'PNOA cedido por \xA9 <a href="http://www.ign.es/ign/main/index.do" target="_blank">Instituto Geogr\xE1fico Nacional de Espa\xF1a</a> contributors',crossOrigin:!0})}),o(g.BaseLayer,{name:"OpenStreetMap",children:o(b,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",crossOrigin:!0})}),o(g.BaseLayer,{name:"OpenTopoMap",children:o(b,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",crossOrigin:!0})})]}),ee=()=>{var e;return l(R,{bounds:[[24.9300000311,-19.6],[46.0700000311,5.6]],children:[((e=window.localStorage.getItem("gpx"))==null?void 0:e.length)===0?null:o(ce,{}),o(Q,{}),o(B,{}),o(Z,{})]})},te=()=>{const{trackState:{displayInfo:t,infoTrack:e},setDisplayInfo:n}=p.exports.useContext(u),{name:s,distance:a,maxElevation:r,time:c}=e,d=f=>{f.stopPropagation()};return l(C,{children:[t&&o("div",{className:"modal__overlay",onClick:()=>n(!1)}),l("div",{className:`modal ${t&&"modal--show"}`,onClick:d,children:[l("div",{className:"modal__header",children:[o("h2",{children:"Track Info"}),o("div",{style:{fontSize:"1.4rem"},children:o(I,{})})]}),s?l("div",{className:"modal__content",children:[l("p",{children:[o("b",{children:"Name:"})," ",s]}),l("p",{children:[o("b",{children:"Distance:"})," ",a]}),l("p",{children:[o("b",{children:"Max. Elevation:"})," ",r]}),l("p",{children:[o("b",{children:"Time:"})," ",c]})]}):o("div",{className:"modal__content",children:o("p",{style:{textAlign:"center"},children:o("strong",{children:"No Info \u{1F641}"})})}),o("div",{className:"modal__footer",children:o("button",{onClick:()=>n(!1),children:"OK"})})]})]})},oe=()=>{const{deleteTrack:t,trackState:e}=p.exports.useContext(u);return o("button",{title:"Remove Track",onClick:()=>{window.localStorage.removeItem("gpx"),t(!e.deleteTrack)},className:"buttons buttons__remove",children:o(F,{})})},ne=()=>{const{setDisplayInfo:t}=p.exports.useContext(u);return o("button",{title:"Track Info",onClick:()=>t(!0),className:"buttons buttons__info",children:o(I,{})})},ae=()=>{const{setLocation:t,trackState:e}=p.exports.useContext(u);return o("button",{title:"Geolocation",onClick:()=>t(!e.location),className:`buttons buttons__location ${e.location&&"buttons__location--active"}`,children:o(P,{})})},re=t=>{const e={};e.name=`${t.get_name()}`,e.distance=`${Math.round(t.get_distance()/1e3*100)/100} km`,e.maxElevation=`${Math.round(t.get_elevation_max()*100)/100} m`;const n=Math.round(t.get_total_time()/36e5*100)/100,s=Math.ceil((n-Math.floor(n))*60);return e.time=`${Math.floor(n)} horas y ${s} minutos`,e},ce=()=>{const t=v(),{trackState:{deleteTrack:e,data:n},setInfoTrack:s}=p.exports.useContext(u);return p.exports.useEffect(()=>{const a=window.localStorage.getItem("gpx")||"",r=new y.GPX(a,{async:!0,marker_options:{wptIconUrls:{"":"markers/pin-icon-wpt.png"},startIconUrl:"markers/pin-icon-start.png",endIconUrl:"markers/pin-icon-end.png",shadowUrl:"markers/pin-shadow.png"}}).on("loaded",c=>{const d=c.target;s(re(d)),t.fitBounds(d.getBounds())}).addTo(t);return()=>{t.removeLayer(r)}},[t,e,n]),null},ie=()=>{const{setTrack:t}=p.exports.useContext(u),e=p.exports.useRef(null);return l(C,{children:[o("label",{title:"Add Track",className:"buttons buttons__label",htmlFor:"input-track",children:o(U,{})}),o("input",{ref:e,type:"file",accept:"application/gpx+xml",id:"input-track",onClick:()=>{e.current&&(e.current.value="")},onChange:a=>{const r=a.target,c=new FileReader;c.onload=()=>{const d=c.result;t(d),window.localStorage.setItem("gpx",d)},r.files&&c.readAsText(r.files[0])}})]})};const se=()=>l(V,{children:[l("header",{children:[o("h4",{children:"Camina \u{1F97E} con mi App GPS / TEST"}),o("p",{children:"(React TS/React-Leaflet)"}),l("div",{className:"controls",children:[o(ie,{}),o(ae,{}),o(oe,{}),o(ne,{}),o(K,{})]})]}),o(ee,{}),o(te,{}),l("footer",{children:["MIT Licensed | Copyright \xA9 ",Date().split(" ")[3]," Enrique Mar\xEDn"]})]});function le(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:a,onRegisterError:r}=t;let c,d;const f=async(i=!0)=>{i&&(c==null||c.addEventListener("controlling",S=>{S.isUpdate&&window.location.reload()})),d&&d.waiting&&await G(d.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){c=new W("/map-gpx/sw.js",{scope:"/map-gpx/"}),c.addEventListener("activated",i=>{i.isUpdate||s==null||s()});{const i=()=>{n==null||n()};c.addEventListener("waiting",i),c.addEventListener("externalwaiting",i)}c.register({immediate:e}).then(i=>{d=i,a==null||a(i)}).catch(i=>{r==null||r(i)})}return f}const de=le({onNeedRefresh(){x.fire({icon:"info",title:"New Content Available!!",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ok, update it!"}).then(t=>{t.isConfirmed&&de()})}});$.render(o(j.StrictMode,{children:o(se,{})}),document.getElementById("root"));
