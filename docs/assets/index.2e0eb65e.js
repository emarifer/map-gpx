var M=Object.defineProperty,_=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var x=(o,e,r)=>e in o?M(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r,m=(o,e)=>{for(var r in e||(e={}))S.call(e,r)&&x(o,r,e[r]);if(k)for(var r of k(e))A.call(e,r)&&x(o,r,e[r]);return o},h=(o,e)=>_(o,L(e));import{r as l,j as t,L as y,u as w,M as C,a as c,P as N,b as f,W as T,T as b,c as O,S as F,F as I,B as v,A as D,d as E,e as P,R,f as U}from"./vendor.d692e607.js";const B=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(a){if(a.ep)return;a.ep=!0;const n=r(a);fetch(a.href,n)}};B();const u=l.exports.createContext({}),$=(o,e)=>{switch(e.type){case"addTrack":return h(m({},o),{data:e.payload});case"startLocation":return h(m({},o),{location:e.payload});case"deleteTrack":return h(m({},o),{deleteTrack:e.payload,data:"",infoTrack:{}});case"setInfo":return h(m({},o),{infoTrack:e.payload});case"setDisplay":return h(m({},o),{displayInfo:e.payload});case"setUserAccurcy":return h(m({},o),{userAccuracy:Math.round(e.payload*100)/100});default:return o}},G={data:"",location:!1,deleteTrack:!1,infoTrack:{},displayInfo:!1,userAccuracy:0},z=({children:o})=>{const[e,r]=l.exports.useReducer($,G),i=d=>{r({type:"addTrack",payload:d})},a=d=>{r({type:"startLocation",payload:d})},n=d=>{r({type:"deleteTrack",payload:d})},s=d=>{r({type:"setInfo",payload:d})},p=d=>{r({type:"setDisplay",payload:d})},g=d=>{r({type:"setUserAccurcy",payload:d})};return t(u.Provider,{value:{trackState:e,setTrack:i,setLocation:a,deleteTrack:n,setInfoTrack:s,setDisplayInfo:p,setUserAccuracy:g},children:o})};var j="/map-gpx/markers/marker-icon.png",q="/map-gpx/markers/marker-shadow.png";const K=y.icon({iconSize:[25,40],iconUrl:j,shadowUrl:q});y.Marker.prototype.options.icon=K;const W=()=>{const{trackState:{location:o,userAccuracy:e},setUserAccuracy:r}=l.exports.useContext(u),[i,a]=l.exports.useState(null),n=w();return l.exports.useEffect(()=>(o?n.locate({watch:!0,timeout:5e3}).on("locationfound",s=>{a(s.latlng),r(s.accuracy)}):a(null),()=>{n.stopLocate()}),[o,n]),i===null?null:t(C,{position:i,children:c(N,{children:["You are less than ",e," meters"]})})},V=()=>c(f,{position:"topright",children:[t(f.BaseLayer,{checked:!0,name:"Mapa raster IGN - Spain",children:t(T,{layers:"mtn_rasterizado",url:"https://www.ign.es/wms-inspire/mapa-raster",attribution:'\xA9 <a href="http://www.ign.es/ign/main/index.do" target="_blank">Instituto Geogr\xE1fico Nacional de Espa\xF1a</a> contributors',crossOrigin:!0})}),t(f.BaseLayer,{name:"Ortoimagen PNOA - Spain",children:t(T,{layers:"OI.OrthoimageCoverage",url:"https://www.ign.es/wms-inspire/pnoa-ma",attribution:'PNOA cedido por \xA9 <a href="http://www.ign.es/ign/main/index.do" target="_blank">Instituto Geogr\xE1fico Nacional de Espa\xF1a</a> contributors',crossOrigin:!0})}),t(f.BaseLayer,{name:"OpenStreetMap",children:t(b,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",crossOrigin:!0})}),t(f.BaseLayer,{name:"OpenTopoMap",children:t(b,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",crossOrigin:!0})})]}),X=()=>{var e;return c(O,{bounds:[[24.9300000311,-19.6],[46.0700000311,5.6]],children:[((e=window.localStorage.getItem("gpx"))==null?void 0:e.length)===0?null:t(ee,{}),t(W,{}),t(F,{}),t(V,{})]})},Y=()=>{const{trackState:{displayInfo:o,infoTrack:e},setDisplayInfo:r}=l.exports.useContext(u),{name:i,distance:a,maxElevation:n,time:s}=e,p=g=>{g.stopPropagation()};return c(I,{children:[o&&t("div",{className:"modal__overlay",onClick:()=>r(!1)}),c("div",{className:`modal ${o&&"modal--show"}`,onClick:p,children:[c("div",{className:"modal__header",children:[t("h2",{children:"Track Info"}),t("div",{style:{fontSize:"1.4rem"},children:t(v,{})})]}),i?c("div",{className:"modal__content",children:[c("p",{children:[t("b",{children:"Name:"})," ",i]}),c("p",{children:[t("b",{children:"Distance:"})," ",a]}),c("p",{children:[t("b",{children:"Max. Elevation:"})," ",n]}),c("p",{children:[t("b",{children:"Time:"})," ",s]})]}):t("div",{className:"modal__content",children:t("p",{style:{textAlign:"center"},children:t("strong",{children:"No Info \u{1F641}"})})}),t("div",{className:"modal__footer",children:t("button",{onClick:()=>r(!1),children:"OK"})})]})]})},H=()=>{const{deleteTrack:o,trackState:e}=l.exports.useContext(u);return t("button",{title:"Remove Track",onClick:()=>{window.localStorage.removeItem("gpx"),o(!e.deleteTrack)},className:"buttons buttons__remove",children:t(D,{})})},J=()=>{const{setDisplayInfo:o}=l.exports.useContext(u);return t("button",{title:"Track Info",onClick:()=>o(!0),className:"buttons buttons__info",children:t(v,{})})},Q=()=>{const{setLocation:o,trackState:e}=l.exports.useContext(u);return t("button",{title:"Geolocation",onClick:()=>o(!e.location),className:`buttons buttons__location ${e.location&&"buttons__location--active"}`,children:t(E,{})})},Z=o=>{const e={};e.name=`${o.get_name()}`,e.distance=`${Math.round(o.get_distance()/1e3*100)/100} km`,e.maxElevation=`${Math.round(o.get_elevation_max()*100)/100} m`;const r=Math.round(o.get_total_time()/36e5*100)/100,i=Math.ceil((r-Math.floor(r))*60);return e.time=`${Math.floor(r)} horas y ${i} minutos`,e},ee=()=>{const o=w(),{trackState:{deleteTrack:e,data:r},setInfoTrack:i}=l.exports.useContext(u);return l.exports.useEffect(()=>{const a=window.localStorage.getItem("gpx")||"",n=new y.GPX(a,{async:!0,marker_options:{wptIconUrls:{"":"markers/pin-icon-wpt.png"},startIconUrl:"markers/pin-icon-start.png",endIconUrl:"markers/pin-icon-end.png",shadowUrl:"markers/pin-shadow.png"}}).on("loaded",s=>{const p=s.target;i(Z(p)),o.fitBounds(p.getBounds())}).addTo(o);return()=>{o.removeLayer(n)}},[o,e,r]),null},te=()=>{const{setTrack:o}=l.exports.useContext(u),e=l.exports.useRef(null);return c(I,{children:[t("label",{title:"Add Track",className:"buttons buttons__label",htmlFor:"input-track",children:t(P,{})}),t("input",{ref:e,type:"file",accept:"application/gpx+xml",id:"input-track",onClick:()=>{e.current&&(e.current.value="")},onChange:a=>{const n=a.target,s=new FileReader;s.onload=()=>{const p=s.result;o(p),window.localStorage.setItem("gpx",p)},n.files&&s.readAsText(n.files[0])}})]})};const oe=()=>c(z,{children:[c("header",{children:[t("h4",{children:"Camina \u{1F97E} con mi App GPS"}),t("p",{children:"(React TS/React-Leaflet)"}),c("div",{className:"controls",children:[t(te,{}),t(Q,{}),t(H,{}),t(J,{})]})]}),t(X,{}),t(Y,{}),c("footer",{children:["MIT Licensed | Copyright \xA9 ",Date().split(" ")[3]," Enrique Mar\xEDn"]})]});R.render(t(U.StrictMode,{children:t(oe,{})}),document.getElementById("root"));
