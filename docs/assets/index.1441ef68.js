var P=Object.defineProperty,R=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var T=(e,t,n)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,m=(e,t)=>{for(var n in t||(t={}))U.call(t,n)&&T(e,n,t[n]);if(C)for(var n of C(t))$.call(t,n)&&T(e,n,t[n]);return e},f=(e,t)=>R(e,j(t));import{c as g,j as o,H as z,S,r as u,L as _,u as I,M as G,a as l,P as W,b as x,T as k,d as q,e as H,F as L,B as M,A as K,f as Y,g as Z,h as V,v as X,n as J,R as Q,i as ee}from"./vendor.aca433e8.js";const te=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}};te();const oe="_controls_kstyc_24",ne="_buttons_kstyc_33";var y={controls:oe,buttons:ne};const ae="_cache_feq8y_1";var re={cache:ae};const ce=()=>{const e=g({[y.buttons]:!0,[re.cache]:!0});return o("button",{className:e,onClick:()=>{S.fire({icon:"warning",title:"Confirmaci\xF3n de eliminaci\xF3n de cach\xE9 de mapa\u2026",text:"Si no tienes conexi\xF3n, perder\xE1s tus datos",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ok, b\xF3rralo!",cancelButtonText:"Cancelar"}).then(n=>{n.isConfirmed&&"caches"in window&&caches.delete("cache-map").then(c=>{console.log(c,"clear cache-map operation")}).catch(c=>{console.log(c)})})},title:"Borrar Cache",children:o(z,{})})},h=u.exports.createContext({}),se=(e,t)=>{switch(t.type){case"addTrack":return f(m({},e),{data:t.payload});case"startLocation":return f(m({},e),{location:t.payload});case"deleteTrack":return f(m({},e),{deleteTrack:t.payload,data:"",infoTrack:{}});case"setInfo":return f(m({},e),{infoTrack:t.payload});case"setDisplay":return f(m({},e),{displayInfo:t.payload});case"setUserAccurcy":return f(m({},e),{userAccuracy:Math.round(t.payload*100)/100});default:return e}},ie={data:"",location:!1,deleteTrack:!1,infoTrack:{},displayInfo:!1,userAccuracy:0},le=({children:e})=>{const[t,n]=u.exports.useReducer(se,ie),c=s=>{n({type:"addTrack",payload:s})},a=s=>{n({type:"startLocation",payload:s})},r=s=>{n({type:"deleteTrack",payload:s})},i=s=>{n({type:"setInfo",payload:s})},d=s=>{n({type:"setDisplay",payload:s})},p=s=>{n({type:"setUserAccurcy",payload:s})};return o(h.Provider,{value:{trackState:t,setTrack:c,setLocation:a,deleteTrack:r,setInfoTrack:i,setDisplayInfo:d,setUserAccuracy:p},children:e})};var de="/map-gpx/markers/marker-icon.png",ue="/map-gpx/markers/marker-shadow.png";const pe=_.icon({iconSize:[25,40],iconAnchor:[12.5,40],popupAnchor:[0,-40],iconUrl:de,shadowUrl:ue});_.Marker.prototype.options.icon=pe;const he=()=>{const{trackState:{location:e,userAccuracy:t},setUserAccuracy:n}=u.exports.useContext(h),[c,a]=u.exports.useState(null),r=I();return u.exports.useEffect(()=>(e?r.locate({watch:!0,timeout:5e3}).on("locationfound",i=>{a(i.latlng),n(i.accuracy),r.flyTo(i.latlng,r.getZoom())}):a(null),()=>{r.stopLocate()}),[e]),c===null?null:o(G,{position:c,children:l(W,{children:["Precisi\xF3n de la posici\xF3n: ",t," m"]})})},me=()=>l(x,{position:"topright",children:[o(x.BaseLayer,{checked:!0,name:"Mapa raster IGN - Spain",children:o(k,{maxZoom:17,url:"https://tms-mapa-raster.ign.es/1.0.0/mapa-raster/{z}/{x}/{-y}.jpeg",attribution:'MTN r\xE1ster CC BY 4.0 <a href="http://www.ign.es/" target="_blank"><b>ign.es</b></a>',crossOrigin:!0})}),o(x.BaseLayer,{name:"Ortoimagen PNOA - Spain",children:o(k,{url:"https://tms-pnoa-ma.ign.es/1.0.0/pnoa-ma/{z}/{x}/{-y}.jpeg",attribution:'Ortofoto PNOA CC-BY 4.0 <a href="http://www.scne.es" target="_blank"><b>scne.es</b></a>',crossOrigin:!0})}),o(x.BaseLayer,{name:"OpenStreetMap",children:o(k,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",crossOrigin:!0})}),o(x.BaseLayer,{name:"OpenTopoMap",children:o(k,{maxZoom:17,attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",crossOrigin:!0})})]}),fe="_leafletContainer_nr6u5_1";var ge={leafletContainer:fe};const ye=()=>{var n;const e=[[24.9300000311,-19.6],[46.0700000311,5.6]],{leafletContainer:t}=ge;return l(q,{bounds:e,className:t,children:[((n=window.localStorage.getItem("gpx"))==null?void 0:n.length)===0?null:o(Re,{}),o(he,{}),o(H,{}),o(me,{})]})},xe="_overlay_oj9hv_1",ke="_modal_oj9hv_11",ve="_show_oj9hv_25",_e="_header_oj9hv_31",we="_content_oj9hv_41",be="_footer_oj9hv_52",Ce="_button_oj9hv_58";var N={overlay:xe,modal:ke,show:ve,header:_e,content:we,footer:be,button:Ce};const Te=g.bind(N),Se=()=>{const{trackState:{displayInfo:e,infoTrack:t},setDisplayInfo:n}=u.exports.useContext(h),{name:c,distance:a,maxElevation:r,time:i}=t,d=D=>{D.stopPropagation()},{overlay:p,modal:s,show:v,header:B,content:b,footer:F,button:E}=N,O=Te({[s]:!0,[v]:e});return l(L,{children:[e&&o("div",{className:p,onClick:()=>n(!1)}),l("div",{className:O,onClick:d,children:[l("div",{className:B,children:[o("h2",{children:"Track Info"}),o("div",{style:{fontSize:"1.4rem"},children:o(M,{})})]}),c?l("div",{className:b,children:[l("p",{children:[o("b",{children:"Nombre:"})," ",c]}),l("p",{children:[o("b",{children:"Distancia:"})," ",a]}),l("p",{children:[o("b",{children:"M\xE1x. Elevaci\xF3n:"})," ",r]}),l("p",{children:[o("b",{children:"Tiempo:"})," ",i]})]}):o("div",{className:b,children:o("p",{style:{textAlign:"center"},children:o("strong",{children:"Sin Informaci\xF3n \u{1F641}"})})}),o("div",{className:F,children:o("button",{className:E,onClick:()=>n(!1),children:"OK"})})]})]})},Ie="_remove_1dphq_1";var Le={remove:Ie};const Me=()=>{const{deleteTrack:e,trackState:t}=u.exports.useContext(h),n=g({[y.buttons]:!0,[Le.remove]:!0});return o("button",{className:n,onClick:()=>{window.localStorage.removeItem("gpx"),e(!t.deleteTrack)},title:"Eliminar Track",children:o(K,{})})},Ne="_info_fq53e_1";var Ae={info:Ne};const Be=()=>{const{setDisplayInfo:e}=u.exports.useContext(h),t=g({[y.buttons]:!0,[Ae.info]:!0});return o("button",{className:t,onClick:()=>e(!0),title:"Info Track",children:o(M,{})})},Fe="_location_vrttu_1",Ee="_active_vrttu_6";var w={location:Fe,active:Ee};const Oe=g.bind(w),De=()=>{const{setLocation:e,trackState:t}=u.exports.useContext(h),n=Oe({[y.buttons]:!0,[w.location]:!0,[w.active]:t.location});return o("button",{className:n,onClick:()=>e(!t.location),title:"Iniciar Geolocalizaci\xF3n",children:o(Y,{})})},Pe=e=>{const t={};t.name=`${e.get_name()}`,t.distance=`${Math.round(e.get_distance()/1e3*100)/100} km`,t.maxElevation=`${Math.round(e.get_elevation_max()*100)/100} m`;const n=Math.round(e.get_total_time()/36e5*100)/100,c=Math.ceil((n-Math.floor(n))*60);return t.time=`${Math.floor(n)} horas y ${c} minutos`,t},Re=()=>{const e=I(),{trackState:{deleteTrack:t,data:n},setInfoTrack:c}=u.exports.useContext(h);return u.exports.useEffect(()=>{const a=window.localStorage.getItem("gpx")||"",r=new _.GPX(a,{async:!0,marker_options:{wptIconUrls:{"":"markers/pin-icon-wpt.png"},startIconUrl:"markers/pin-icon-start.png",endIconUrl:"markers/pin-icon-end.png",shadowUrl:"markers/pin-shadow.png"}}).on("loaded",i=>{const d=i.target;c(Pe(d)),e.fitBounds(d.getBounds())}).addTo(e);return()=>{e.removeLayer(r)}},[e,t,n]),null},je="_label_1x4aj_1",Ue="_input_1x4aj_5";var A={label:je,input:Ue};const $e=()=>{const e=g({[y.buttons]:!0,[A.label]:!0}),{setTrack:t}=u.exports.useContext(h),n=u.exports.useRef(null),c=()=>{n.current&&(n.current.value="")},a=r=>{const i=r.target,d=new FileReader;d.onload=()=>{const p=d.result;t(p),window.localStorage.setItem("gpx",p)},i.files&&d.readAsText(i.files[0])};return l(L,{children:[o("label",{className:e,htmlFor:"input-track",title:"A\xF1adir Track",children:o(Z,{})}),o("input",{accept:"application/gpx+xml",className:A.input,id:"input-track",onChange:a,onClick:c,ref:n,type:"file"})]})},ze=()=>l(le,{children:[l("header",{children:[o("h4",{children:"Camina \u{1F97E} con mi App GPS"}),l("p",{children:["(PWA - React+TS/React-Leaflet)",o("a",{href:"https://github.com/emarifer/map-gpx/tree/added_css_modules",rel:"noopener noreferrer",target:"_blank",title:"Mi GitHub",children:o(V,{})})]}),l("div",{className:y.controls,children:[o($e,{}),o(De,{}),o(Me,{}),o(Be,{}),o(ce,{})]})]}),o(ye,{}),o(Se,{}),l("footer",{children:["MIT Licensed | Copyright \xA9 ",new Date().getFullYear()," Enrique Mar\xEDn"]})]});function Ge(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:c,onRegistered:a,onRegisterError:r}=e;let i,d;const p=async(s=!0)=>{s&&(i==null||i.addEventListener("controlling",v=>{v.isUpdate&&window.location.reload()})),d&&d.waiting&&await J(d.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){i=new X("/map-gpx/sw.js",{scope:"/map-gpx/"}),i.addEventListener("activated",s=>{s.isUpdate||c==null||c()});{const s=()=>{n==null||n()};i.addEventListener("waiting",s),i.addEventListener("externalwaiting",s)}i.register({immediate:t}).then(s=>{d=s,a==null||a(s)}).catch(s=>{r==null||r(s)})}return p}const We=Ge({onNeedRefresh(){S.fire({icon:"info",title:"Nuevo contenido disponible!!",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ok, Actual\xEDzame!",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&We()})}});Q.render(o(ee.StrictMode,{children:o(ze,{})}),document.getElementById("root"));
