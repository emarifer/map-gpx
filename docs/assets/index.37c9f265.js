var j=Object.defineProperty,P=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var T=(e,t,n)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,m=(e,t)=>{for(var n in t||(t={}))U.call(t,n)&&T(e,n,t[n]);if(C)for(var n of C(t))$.call(t,n)&&T(e,n,t[n]);return e},f=(e,t)=>P(e,R(t));import{c as g,j as o,H as z,S,r as u,L as _,u as I,M as W,a as l,P as q,b as v,T as x,d as G,e as K,F as L,B as M,A as Y,f as Z,g as H,v as V,n as X,R as J,h as Q}from"./vendor.c2d8e74f.js";const ee=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}};ee();const te="_controls_vgjw1_13",oe="_buttons_vgjw1_22";var y={controls:te,buttons:oe};const ne="_cache_feq8y_1";var ae={cache:ne};const re=()=>{const e=g({[y.buttons]:!0,[ae.cache]:!0});return o("button",{className:e,onClick:()=>{S.fire({icon:"warning",title:"Confirmaci\xF3n de eliminaci\xF3n de cach\xE9 de mapa\u2026",text:"Si no tienes conexi\xF3n, perder\xE1s tus datos",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ok, b\xF3rralo!",cancelButtonText:"Cancelar"}).then(n=>{n.isConfirmed&&"caches"in window&&caches.delete("cache-map").then(c=>{console.log(c,"clear cache-map operation")}).catch(c=>{console.log(c)})})},title:"Borrar Cache",children:o(z,{})})},h=u.exports.createContext({}),ce=(e,t)=>{switch(t.type){case"addTrack":return f(m({},e),{data:t.payload});case"startLocation":return f(m({},e),{location:t.payload});case"deleteTrack":return f(m({},e),{deleteTrack:t.payload,data:"",infoTrack:{}});case"setInfo":return f(m({},e),{infoTrack:t.payload});case"setDisplay":return f(m({},e),{displayInfo:t.payload});case"setUserAccurcy":return f(m({},e),{userAccuracy:Math.round(t.payload*100)/100});default:return e}},se={data:"",location:!1,deleteTrack:!1,infoTrack:{},displayInfo:!1,userAccuracy:0},ie=({children:e})=>{const[t,n]=u.exports.useReducer(ce,se),c=s=>{n({type:"addTrack",payload:s})},a=s=>{n({type:"startLocation",payload:s})},r=s=>{n({type:"deleteTrack",payload:s})},i=s=>{n({type:"setInfo",payload:s})},d=s=>{n({type:"setDisplay",payload:s})},p=s=>{n({type:"setUserAccurcy",payload:s})};return o(h.Provider,{value:{trackState:t,setTrack:c,setLocation:a,deleteTrack:r,setInfoTrack:i,setDisplayInfo:d,setUserAccuracy:p},children:e})};var le="/map-gpx/markers/marker-icon.png",de="/map-gpx/markers/marker-shadow.png";const ue=_.icon({iconSize:[25,40],iconAnchor:[12.5,40],popupAnchor:[0,-40],iconUrl:le,shadowUrl:de});_.Marker.prototype.options.icon=ue;const pe=()=>{const{trackState:{location:e,userAccuracy:t},setUserAccuracy:n}=u.exports.useContext(h),[c,a]=u.exports.useState(null),r=I();return u.exports.useEffect(()=>(e?r.locate({watch:!0,timeout:5e3}).on("locationfound",i=>{a(i.latlng),n(i.accuracy),r.flyTo(i.latlng,r.getZoom())}):a(null),()=>{r.stopLocate()}),[e]),c===null?null:o(W,{position:c,children:l(q,{children:["Precisi\xF3n de la posici\xF3n: ",t," m"]})})},he=()=>l(v,{position:"topright",children:[o(v.BaseLayer,{checked:!0,name:"Mapa raster IGN - Spain",children:o(x,{maxZoom:17,url:"https://tms-mapa-raster.ign.es/1.0.0/mapa-raster/{z}/{x}/{-y}.jpeg",attribution:'MTN r\xE1ster CC BY 4.0 <a href="http://www.ign.es/" target="_blank"><b>ign.es</b></a>',crossOrigin:!0})}),o(v.BaseLayer,{name:"Ortoimagen PNOA - Spain",children:o(x,{url:"https://tms-pnoa-ma.ign.es/1.0.0/pnoa-ma/{z}/{x}/{-y}.jpeg",attribution:'Ortofoto PNOA CC-BY 4.0 <a href="http://www.scne.es" target="_blank"><b>scne.es</b></a>',crossOrigin:!0})}),o(v.BaseLayer,{name:"OpenStreetMap",children:o(x,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",crossOrigin:!0})}),o(v.BaseLayer,{name:"OpenTopoMap",children:o(x,{maxZoom:17,attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",crossOrigin:!0})})]}),me="_leafletContainer_nr6u5_1";var fe={leafletContainer:me};const ge=()=>{var n;const e=[[24.9300000311,-19.6],[46.0700000311,5.6]],{leafletContainer:t}=fe;return l(G,{bounds:e,className:t,children:[((n=window.localStorage.getItem("gpx"))==null?void 0:n.length)===0?null:o(je,{}),o(pe,{}),o(K,{}),o(he,{})]})},ye="_overlay_oj9hv_1",ve="_modal_oj9hv_11",xe="_show_oj9hv_25",ke="_header_oj9hv_31",_e="_content_oj9hv_41",we="_footer_oj9hv_52",be="_button_oj9hv_58";var N={overlay:ye,modal:ve,show:xe,header:ke,content:_e,footer:we,button:be};const Ce=g.bind(N),Te=()=>{const{trackState:{displayInfo:e,infoTrack:t},setDisplayInfo:n}=u.exports.useContext(h),{name:c,distance:a,maxElevation:r,time:i}=t,d=D=>{D.stopPropagation()},{overlay:p,modal:s,show:k,header:F,content:b,footer:B,button:E}=N,O=Ce({[s]:!0,[k]:e});return l(L,{children:[e&&o("div",{className:p,onClick:()=>n(!1)}),l("div",{className:O,onClick:d,children:[l("div",{className:F,children:[o("h2",{children:"Track Info"}),o("div",{style:{fontSize:"1.4rem"},children:o(M,{})})]}),c?l("div",{className:b,children:[l("p",{children:[o("b",{children:"Nombre:"})," ",c]}),l("p",{children:[o("b",{children:"Distancia:"})," ",a]}),l("p",{children:[o("b",{children:"Max. Elevaci\xF3n:"})," ",r]}),l("p",{children:[o("b",{children:"Tiempo:"})," ",i]})]}):o("div",{className:b,children:o("p",{style:{textAlign:"center"},children:o("strong",{children:"Sin Informaci\xF3n \u{1F641}"})})}),o("div",{className:B,children:o("button",{className:E,onClick:()=>n(!1),children:"OK"})})]})]})},Se="_remove_1dphq_1";var Ie={remove:Se};const Le=()=>{const{deleteTrack:e,trackState:t}=u.exports.useContext(h),n=g({[y.buttons]:!0,[Ie.remove]:!0});return o("button",{className:n,onClick:()=>{window.localStorage.removeItem("gpx"),e(!t.deleteTrack)},title:"Eliminar Track",children:o(Y,{})})},Me="_info_fq53e_1";var Ne={info:Me};const Ae=()=>{const{setDisplayInfo:e}=u.exports.useContext(h),t=g({[y.buttons]:!0,[Ne.info]:!0});return o("button",{className:t,onClick:()=>e(!0),title:"Info Track",children:o(M,{})})},Fe="_location_vrttu_1",Be="_active_vrttu_6";var w={location:Fe,active:Be};const Ee=g.bind(w),Oe=()=>{const{setLocation:e,trackState:t}=u.exports.useContext(h),n=Ee({[y.buttons]:!0,[w.location]:!0,[w.active]:t.location});return o("button",{className:n,onClick:()=>e(!t.location),title:"Iniciar Geolocalizaci\xF3n",children:o(Z,{})})},De=e=>{const t={};t.name=`${e.get_name()}`,t.distance=`${Math.round(e.get_distance()/1e3*100)/100} km`,t.maxElevation=`${Math.round(e.get_elevation_max()*100)/100} m`;const n=Math.round(e.get_total_time()/36e5*100)/100,c=Math.ceil((n-Math.floor(n))*60);return t.time=`${Math.floor(n)} horas y ${c} minutos`,t},je=()=>{const e=I(),{trackState:{deleteTrack:t,data:n},setInfoTrack:c}=u.exports.useContext(h);return u.exports.useEffect(()=>{const a=window.localStorage.getItem("gpx")||"",r=new _.GPX(a,{async:!0,marker_options:{wptIconUrls:{"":"markers/pin-icon-wpt.png"},startIconUrl:"markers/pin-icon-start.png",endIconUrl:"markers/pin-icon-end.png",shadowUrl:"markers/pin-shadow.png"}}).on("loaded",i=>{const d=i.target;c(De(d)),e.fitBounds(d.getBounds())}).addTo(e);return()=>{e.removeLayer(r)}},[e,t,n]),null},Pe="_label_1x4aj_1",Re="_input_1x4aj_5";var A={label:Pe,input:Re};const Ue=()=>{const e=g({[y.buttons]:!0,[A.label]:!0}),{setTrack:t}=u.exports.useContext(h),n=u.exports.useRef(null),c=()=>{n.current&&(n.current.value="")},a=r=>{const i=r.target,d=new FileReader;d.onload=()=>{const p=d.result;t(p),window.localStorage.setItem("gpx",p)},i.files&&d.readAsText(i.files[0])};return l(L,{children:[o("label",{className:e,htmlFor:"input-track",title:"A\xF1adir Track",children:o(H,{})}),o("input",{accept:"application/gpx+xml",className:A.input,id:"input-track",onChange:a,onClick:c,ref:n,type:"file"})]})},$e=()=>l(ie,{children:[l("header",{children:[o("h4",{children:"Camina \u{1F97E} con mi App GPS"}),o("p",{children:"(PWA - React TS/React-Leaflet)"}),l("div",{className:y.controls,children:[o(Ue,{}),o(Oe,{}),o(Le,{}),o(Ae,{}),o(re,{})]})]}),o(ge,{}),o(Te,{}),l("footer",{children:["MIT Licensed | Copyright \xA9 ",new Date().getFullYear()," Enrique Mar\xEDn"]})]});function ze(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:c,onRegistered:a,onRegisterError:r}=e;let i,d;const p=async(s=!0)=>{s&&(i==null||i.addEventListener("controlling",k=>{k.isUpdate&&window.location.reload()})),d&&d.waiting&&await X(d.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){i=new V("/map-gpx/sw.js",{scope:"/map-gpx/"}),i.addEventListener("activated",s=>{s.isUpdate||c==null||c()});{const s=()=>{n==null||n()};i.addEventListener("waiting",s),i.addEventListener("externalwaiting",s)}i.register({immediate:t}).then(s=>{d=s,a==null||a(s)}).catch(s=>{r==null||r(s)})}return p}const We=ze({onNeedRefresh(){S.fire({icon:"info",title:"Nuevo contenido disponible!!",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ok, Actual\xEDzame!",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&We()})}});J.render(o(Q.StrictMode,{children:o($e,{})}),document.getElementById("root"));
